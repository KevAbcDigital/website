<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>formulaire</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
        <link rel="stylesheet" type="text/css" href="design_files/css/style.css">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
               
        <script type="text/javascript" src="jquery-3.3.1.min.js"></script>
        <script type="text/javascript" src="floating-wpp.min.js"></script>
        <link rel="stylesheet" href="floating-wpp.min.css">

        <!-- MATERIAL DESIGN ICONIC FONT -->
        <link rel="stylesheet" href="design_files/fonts/material-design-iconic-font/css/material-design-iconic-font.min.css">
                
        <!-- STYLE CSS -->
        <link rel="stylesheet" href="design_files/css/style.css">
    
        <!-- javadev -->

        <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>

    </head>

    <body style="background-image: linear-gradient(rgba(0, 0, 0, 0) , rgba(0, 0, 0, 0)), 
    url(./design_files/images/fondforma.jpg); background-size: cover; background-position: top; width: 100%;
    position: fixed; top: 0; left: 0; right: 0; z-index: 1050; align-items: center;
    justify-content: center;">
        
        
        <header style="background-color: transparent">

            <input type="checkbox" id="menu-bar">
            <label for="menu-bar">
                <img class="imgmenu" src="./design_files/images/images/menubtnblanc.png" alt="image">
            </label>
            
            <div class="logo">
                <img onclick="openhome();" src="./design_files/images/pngolf.png" alt="image">
            </div>

            
            <div class="menutop">
                <ul>

                    <li class="boutonm" > <img style="width: 100%; height: auto;" src="./design_files/images/menushow.jpg" alt="image"> </li>
                    
                    <li class="boutonm"><a style=" color: rgb(255, 255, 255); font-size: 7px; font-weight: 300; text-align: center;
                        width: 100%; font-family: 'Poppins', sans-serif;">By Kevdesign</a>
                    </li>


                    <li class="boutonm" onclick="opentk();" >
                         <img style="width: 94%; margin-top: 2px; margin-left: 3%; height: auto;" src="./design_files/images/boxa.png" alt="image">
                    </li>

                   <li class="boutonm" onclick="openhome();" >
                        <img style="width: 94%; margin-top: 6px; margin-left: 3%; height: auto;" src="./design_files/images/boxd.png" alt="image">
                   </li>

                   <li class="boutonm" onclick="openamical();" >
                        <img style="width: 94%; margin-left: 3%; margin-top: 5px; height: auto;" src="./design_files/images/boxb.png" alt="image">
                   </li>

                   <li class="boutonm"><a> </a></li>
                   <li class="boutonm"><a> </a></li>
                   <li class="boutonm"><a> </a></li>
                    
                </ul>
            </div>

        </header>

        
        <section style=" position: absolute; bottom: 0 ; left: 0; right: 0; margin-left: 14px; margin-right: 14px;
        margin-bottom: 110px; border-radius: 20px; background-color: transparent;" class="formulaire" id="formulaire">
           <div style="padding-top: 17px;" class="devisbloc ">

               <form name="formweb" style="padding: 0 35px;" action="">

                <h1 style="font-weight: 600; margin-bottom: 50px; font-size: 30px; color: rgb(238, 255, 0);">Inscrivez vous</h1>

                <div class="form-wrapper">
                    <a style="color: rgb(234, 254, 117);" class="titleform">Noms et prénoms du joueur *</a>
                    <input id="nomuser" style="border: 1px solid #008006ab; padding-left: 15px;" type="text" placeholder="Entrez le nom complet du joueur ..." class="form-controla">
                </div>

                <div class="form-wrapper" style="margin-bottom: 1px;">
                    <a style="color: rgb(234, 254, 117);" class="titleform">Telephone * ( Ex : 6xxxxxxxx )</a>
                    <input id="teluser" style="border: 1px solid #0cca057a; padding-left: 15px;" type="number" placeholder="Entrez le numéro de téléphone ..." class="form-controla">
                    <i class="zmdi zmdi zmdi-email" style="margin-right: 15px;"></i>
                </div>

                <div class="form-wrapper">
                    <a style="color: rgb(234, 254, 117);" class="titleform">Code du tournoi *</a>
                    <input id="codeopen" style=" border: 1px solid #03b60381; padding-left: 15px;" type="text" placeholder="Entrez le code du tournoi " class="form-controla">
                </div>

                <div class="form-group container-login100-form-btn" style="margin-bottom: 20px;">
                    <button id="valider" style="border-radius: 6px; margin-top: 35px; background-color: rgb(225, 255, 2); color: rgb(9, 4, 4);
                          box-shadow: -1px 1px 9px #f4fa9bd2; " type="button" onclick="send()">
                        Envoyer
                        <i class="zmdi zmdi-arrow-right"></i>
                    </button>
                </div>
       
               </form>

                   </lottie-player>
                   <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
                   <lottie-player style="color: #008006ab; margin-top: -5px;" class="lottiescript" id="lottieload" src="https://lottie.host/7d8680f1-08e2-48c5-b9c5-d85e94277409/h4XhZ3sxIH.json"
                    background="transparent" speed="1"  loop autoplay></lottie-player>


           </div>
       </section>
        

    </body>

    <script>


        function opena() {
            window.alert('aucune information disponible pour le moment')
        }
        function openb() {
            window.alert('aucune information disponible pour le moment')
        }
        function opentk() {
            window.location.href = 'https://kevabcdigital.github.io/website/formamicale.html';
        }
        function openhome() {
            window.location.href = 'https://kevabcdigital.github.io/website/home.html';
        }
        function openamical() {
            window.location.href = 'https://kevabcdigital.github.io/website/amicalscore.html';
        }
        
            

        const firebaseConfig = {
            databaseURL : "https://nlogagolf-ed63e-default-rtdb.asia-southeast1.firebasedatabase.app",
            apiKey: "AIzaSyCDKDeQxFPyVRMyMaxvcOFrxva2Fn7iKnw",
            authDomain: "nlogagolf-ed63e.firebaseapp.com",
            projectId: "nlogagolf-ed63e",
            storageBucket: "nlogagolf-ed63e.appspot.com",
            messagingSenderId: "104686743459",
            appId: "1:104686743459:web:c380b6e47ebb21d413f416",
            measurementId: "G-6BW97RHV89"
        };
        firebase.initializeApp(firebaseConfig)
    
        const database = firebase.database();
    
        function containsOnlyNumbers(str) {
            return /^\d+$/.test(str); 
        }

        function send(){
            
            var load = document.getElementById("lottieload");                
            var nom = $('#nomuser').val().toLowerCase().trim();
            var tel = $('#teluser').val();
            var codeopen = $('#codeopen').val();
            var p = 0;
            var dataRef = firebase.database().ref("open");

            if ( nom != "" & tel != "" & codeopen != "" & tel.length == 9 & ( containsOnlyNumbers(tel) == true ) ) {

                load.style.display = "block";
                var play = (nom.toLowerCase().trim()) ;


                var c = 0;
                dataRef.on("value" , function(snapshot){
                    var i = 0;
                    snapshot.forEach(function(element){
                        if(element.key == codeopen) {
                            i = 1;
                        }
                    });
                    if ( ( i == 1 ) & ( c == 0 ) ) {
                        c = 1;



















                        
                        var l = 0;
                        dataRef.child(codeopen).on("value" , function(snapshot){
                            var j = 0;
                            snapshot.forEach(function(element){
                                if(element.key == nom) {
                                    j = 1;
                                }
                            });

                            if ( j == 0 ) {
                                var dataRefb = firebase.database().ref("open").child(codeopen).child(nom);
                                l = 1;
                                dataRefb.set({  
                                    'nom' : (nom) ,
                                }).then(()=>{
                                    load.style.display = 'none';
                                    window.alert("enregistrement reuissi. !");
                                    window.location.href = 'https://kevabcdigital.github.io/website/formulaire.html';                    
                                                        
                                }).catch((error)=>{
                                    load.style.display = 'none';
                                    window.alert("erreur survenue : "+ error);
                                });
                            }
                            
                            if ( ( j == 1 ) & ( l == 0 ) ) {
                                load.style.display = "none";
                                window.alert("le joueur ( " + nom + " ) a déjà été inscrit à ce tournoi .");
                                window.location.href = 'https://kevabcdigital.github.io/website/formulaire.html';
                            }
                        });
                




















                    }
                    if ( ( i == 0 ) & ( c == 0 ) ) {
                        load.style.display = "none";
                        window.alert("Ce code " + codeopen + " est invalide .");
                        window.location.href = 'https://kevabcdigital.github.io/website/formulaire.html';
                    }


                });
                



                
   
            } else if ( nom == "" ) {
                window.alert("veuillez entrer le nom complet dans l'ordre...");
            } else if ( tel == "" ) {
                window.alert("Veuillez entrer le numero de téléphone du joueur ...");
            } else if ( containsOnlyNumbers(tel) == false ) {
                window.alert("Le numero de téléphone devra contenir uniquement des chiffres ...");
            } else if ( tel.length != 9 ) {
                window.alert("Veuillez entrer numero de téléphone à 09 chiffres ...");
            } else if ( club == "" ) {
                window.alert("Veuillez saisir le code du tournoi");
            }
    
        }

        function invalid() {
            window.alert("Desolé ce formulaire est indisponible pour le moment.");
            window.location.href = 'https://kevabcdigital.github.io/website/home.html';
        }


    </script>
    

</html>
